@use '@uq-uidf/core/src/scss/global' as core;
@use '@uq-uidf/foundation-global/src/scss/global' as *;
@use 'global' as *;
@import 'font-awesome/scss/mixins';
@import 'legacy';

// Variants:
// .form--transparent-fieldsets - Removes the default styling applied to fieldsets.
//

.form {
  &__required {
    color: core.$alert;
  }

  &__description {
    color: $form-description-color;
    font-size: .875rem;
    font-style: italic;
    margin-bottom: core.$space;
  }

  &__help-text {
    color: $form-description-color;
    font-size: .875rem;
    margin-top: core.$space-none;
    margin-bottom: core.$space;
  }

  &__inline-error-message {
    background-color: core.$alert;
    color: core.$uq-white;
    display: block;
    font-size: rem-calc(14px);
    font-style: normal;
    font-weight: 400;
    line-height: 1.357;
    margin-bottom: core.$space;
    padding: core.$space-sm;
  }

  &--transparent-fieldsets {
    fieldset {
      border: 0;
      padding: core.$space-none;
      margin: core.$space-none;
    }
  }
}

legend {
  &.form__legend {
    &.form__legend--error {
      color: core.$alert;
    }
  }
}

fieldset {
  legend {
    font-size: .875rem;
    font-weight: 500;
    line-height: 1.5;
    padding: core.$space-none;
    margin-bottom: core.$space;
  }
}

label {
  font-weight: 500;
  margin-bottom: core.$space;
  white-space: normal;

  + input[type="text"], 
  + input[type="password"], 
  + input[type="date"],
  + input[type="datetime"], 
  + input[type="datetime-local"], 
  + input[type="month"], 
  + input[type="week"], 
  + input[type="email"], 
  + input[type="number"], 
  + input[type="search"], 
  + input[type="tel"],
  + input[type="time"],
  + input[type="url"], 
  + input[type="color"], 
  + textarea,
  + select {
    margin-top: -(rem-calc(12px));
  }

  > input[type="text"], 
  > input[type="password"], 
  > input[type="date"],
  > input[type="datetime"], 
  > input[type="datetime-local"], 
  > input[type="month"], 
  > input[type="week"], 
  > input[type="email"], 
  > input[type="number"], 
  > input[type="search"], 
  > input[type="tel"],
  > input[type="time"],
  > input[type="url"], 
  > input[type="color"], 
  > textarea,
  > select {
    margin-bottom: core.$space-none;
    margin-top: rem-calc(core.$space-xs);
  }

  &.form__label {
    &.form__label--disabled {
      color: core.$uq-neutral-dark20;
      cursor: not-allowed;
    }
    &.form__label--error {
      color: core.$alert;
      position: relative;

      > input[type="text"], 
      > input[type="password"], 
      > input[type="date"],
      > input[type="datetime"], 
      > input[type="datetime-local"], 
      > input[type="month"], 
      > input[type="week"], 
      > input[type="email"], 
      > input[type="number"], 
      > input[type="search"], 
      > input[type="tel"],
      > input[type="time"],
      > input[type="url"], 
      > input[type="color"], 
      > textarea,
      > select {
        &.form__input {
          &.form__input--error {
            + .form__inline-error-message {
              margin-top: core.$space-none;
            }
          }
        }
      }

      > input[type="checkbox"],
      > input[type="radio"] {
        &.form__input {
          &.form__input--error {
            &:before {
              background-color: $alert;
              bottom: -4px;
              content: "";
              display: inline-block;
              left: 0;
              position: absolute;
              top: -4px;
              width: 3px;
            }
          }
        }
      }
    }
  }
}

input[type="text"], 
input[type="password"], 
input[type="date"],
input[type="datetime"], 
input[type="datetime-local"], 
input[type="month"], 
input[type="week"], 
input[type="email"], 
input[type="number"], 
input[type="search"], 
input[type="tel"],
input[type="time"],
input[type="url"], 
input[type="color"], 
textarea, 
select {
  &.form__input {
    &.form__input--error {
      border-color: core.$alert;

      &:focus {
        border-color: core.$alert;
      }
    }

    + .form__inline-error-message {
      margin-top: -core.$space;
    }
  }
}

input[type="checkbox"],
input[type="radio"] {
  float: left;
  clear: left;
  margin-bottom: core.$space-none;
  margin-right: rem-calc(core.$space-sm);
  margin-top: rem-calc(core.$space-xs);
  
  + label {
    font-weight: 300;
    display: block;
    margin-left: core.$space-none;
    margin-right: core.$space-none;
    margin-bottom: core.$space;
    // So long labels on multiple lines don't break around the radio/checkbox.
    max-width: 80%;
    //vertical-align: top;

    @media #{$medium-up} {
      max-width: 85%;
    }
  }

  &.form__input {
    &.form__input--error {
      margin-left: core.$space-sm;
    }
  }

  + label {
    &.form__label {
      &.form__label--error {
        &:before {
          background-color: $alert;
          bottom: -core.$space-xs;
          content: "";
          display: inline-block;
          left: 0;
          position: absolute;
          top: -4px;
          width: 3px;
        }
      }
    }
  }
}

input:not([type])[disabled], 
input:not([type])[readonly], 
fieldset[disabled] input:not([type]), 
input[type="text"][disabled], 
input[type="text"][readonly], 
fieldset[disabled] input[type="text"], 
input[type="password"][disabled], 
input[type="password"][readonly], 
fieldset[disabled] input[type="password"], 
input[type="date"][disabled], 
input[type="date"][readonly], 
fieldset[disabled] input[type="date"], 
input[type="datetime"][disabled], 
input[type="datetime"][readonly], 
fieldset[disabled] input[type="datetime"], 
input[type="datetime-local"][disabled], 
input[type="datetime-local"][readonly], 
fieldset[disabled] input[type="datetime-local"], 
input[type="month"][disabled], 
input[type="month"][readonly], 
fieldset[disabled] input[type="month"], 
input[type="week"][disabled], 
input[type="week"][readonly], 
fieldset[disabled] input[type="week"], 
input[type="email"][disabled], 
input[type="email"][readonly], 
fieldset[disabled] input[type="email"], 
input[type="number"][disabled], 
input[type="number"][readonly], 
fieldset[disabled] input[type="number"], 
input[type="search"][disabled], 
input[type="search"][readonly], 
fieldset[disabled] input[type="search"], 
input[type="tel"][disabled], 
input[type="tel"][readonly], 
fieldset[disabled] input[type="tel"], 
input[type="time"][disabled], 
input[type="time"][readonly], 
fieldset[disabled] input[type="time"], 
input[type="url"][disabled], 
input[type="url"][readonly], 
fieldset[disabled] input[type="url"], 
input[type="color"][disabled], 
input[type="color"][readonly], 
fieldset[disabled] input[type="color"], 
textarea[disabled], textarea[readonly], 
fieldset[disabled] textarea,
input[type="submit"][disabled],
input[type="submit"][readonly],
input[type="button"][disabled],
input[type="button"][readonly],
button[disabled],
button[readonly],
input[type="reset"][disabled],
input[type="reset"][readonly] {
  cursor: not-allowed;
}

// Override Foundation which removes bottom margin from fields which have
// errors.
input.error,
textarea.error {
  margin-bottom: core.$space;
}

input.field-add-more-submit {
  clear: both;
  float: right;
}

input[type='reset'] {
  -webkit-appearance: none;
  -moz-appearance: none;
  border-radius: 0;
  border-style: solid;
  border-width: 0;
  cursor: pointer;
  font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-weight: normal;
  line-height: normal;
  margin: core.$space-none core.$space-none core.$space-md;
  position: relative;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  padding: core.$space core.$space-lg;
  font-size: 1rem;
  background-color: core.$uq-red-dark20; //#f04124
  border-color: core.$uq-red-dark40; //#cf2a0e
  color: core.$uq-white;

  &:hover, &:focus {
    background-color: core.$uq-red-dark40; //#cf2a0e
    color: core.$uq-white;
  }
}

.form-required {
  color: $form-required-color;
}

// Visually connect file uploads to the upload button.
.form-managed-file .form-file {
  background: transparent;
  border: 1px dashed core.$uq-neutral; //#ddd
  border-right: core.$space-none;
  padding: core.$space; //0.8rem
}

.form-radios,
.form-checkboxes {
  margin-bottom: core.$space;
}

.captcha {
  margin: core.$space core.$space-none;

  img {
    margin-bottom: core.$space-sm;
  }
}

input[type="text"], 
input[type="password"], 
input[type="date"],
input[type="datetime"], 
input[type="datetime-local"], 
input[type="month"], 
input[type="week"], 
input[type="email"], 
input[type="number"], 
input[type="search"], 
input[type="tel"],
input[type="time"],
input[type="url"], 
input[type="color"], 
textarea, 
select {
  &.form__input {
    &.form__input--error {
      border-color: $alert;

      &:focus {
        border-color: $alert;
      }
    }

    + .form__inline-error-message {
      margin-top: -core.$space;
    }
  }
}

// Override Foundation default full width for input fields.
input[type='text'],
input[type='password'],
input[type='date'],
input[type='datetime'],
input[type='datetime-local'],
input[type='month'],
input[type='week'],
input[type='email'],
input[type='number'],
input[type='search'],
input[type='tel'],
input[type='time'],
input[type='url'],
input[type='color'],
input[type='file'] {
  @media #{$medium-up} {
    max-width: 100%;
    width: auto;
  }
}

// Full-width form field variant for situations where fields should fit the
// full container.
.form--full-width {
  input[type='text'],
  input[type='password'],
  input[type='date'],
  input[type='datetime'],
  input[type='datetime-local'],
  input[type='month'],
  input[type='week'],
  input[type='email'],
  input[type='number'],
  input[type='search'],
  input[type='tel'],
  input[type='time'],
  input[type='url'],
  input[type='color'],
  input[type='file'] {
    @media #{$medium-up} {
      width: 100%;
    }
  }
}

.description {
  color: $form-description-color;
  font-size: 0.875rem;
  font-style: italic;
  margin-bottom: core.$space;
}

// Move description closer to input fields.
input,
textarea,
.resizable-textarea,
.date-date {
  & + .description {
    margin-top: -core.$space;
  }
}

.field-multiple-drag {
  background: repeating-linear-gradient(
    -55deg,
    $uq-white,
    $uq-white 2px,
    $uq-neutral-light20 2px,
    $uq-neutral-light20 4px
  ); //#f2f2f2

  .handle {
    width: 0;
    &::before {
      @include fa-icon;
      content: $fa-var-arrows;
      color: core.$uq-neutral-dark40; //#777
    }
  }
}

select[multiple='multiple'] {
  height: auto;
  max-height: 4rem;
}

.error-summary {
  background-color: desaturate(lighten(core.$alert, 62.5%), 25%);
  border: 1px solid core.$alert;
  border-left-width: 3px;
  padding: $column-gutter / 2;
  margin-bottom: core.$space-md;
  &__title {
    color: core.$body-font-color;
    font-size: 1.125rem;
    font-weight: 500;
    margin: core.$space-none core.$space-none core.$space core.$space-none;
  }
  &_body {
    color: $body-font-color;
    font-size: core.$space; //.875rem
  }
  &__list {
    color: $body-font-color;
    font-size: core.$space; //.875rem
    margin: 0;
    &__item {
      margin-bottom: core.$space-xs;
      line-height: 1.5;
    }
    a {
      color: core.$alert;
      text-decoration: underline;
      font-weight: 400;
      &:hover, &:focus {
        color: darken(core.$alert, 5%);
      }
    }
  }
}
